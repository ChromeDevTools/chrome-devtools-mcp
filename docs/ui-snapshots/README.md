# ChatGPT UI Snapshots

This directory contains diagnostic snapshots of ChatGPT's UI structure, automatically generated by the `diagnose_chatgpt_ui` tool.

## Purpose

When ChatGPT updates its UI, our automation tools may break. This diagnostic tool helps developers quickly understand what changed and how to fix it.

## File Types

Each diagnosis creates 4 files:

1. **`chatgpt-YYMMDD-HHMMSS.html`** - Complete HTML snapshot
2. **`chatgpt-YYMMDD-HHMMSS.png`** - Full-page screenshot
3. **`chatgpt-YYMMDD-HHMMSS-ax.json`** - Accessibility tree (JSON format)
4. **`chatgpt-YYMMDD-HHMMSS-report.md`** - Diagnostic report with element detection results

## Usage

Run the diagnosis tool via MCP:

```typescript
await use_mcp_tool("chrome-ai-bridge", "diagnose_chatgpt_ui", {
  url: "https://chatgpt.com/",
  waitForLoad: 5000
});
```

## Report Structure

The diagnostic report includes:

### Element Detection Results

For each important UI element:
- ✅ **Found**: Element detected successfully with working selectors
- ⚠️ **Structure Changed**: Element found but some selectors may need updating
- ❌ **Not Found**: Element not detected (major UI change)

### Detected Elements

1. **Deep Research Toggle** - DeepResearch mode activation button
2. **Composer Textarea** - Main input field for messages
3. **Send Button** - Message submission button
4. **Model Selector** - ChatGPT model selection dropdown

### Generated Files

List of all files created during the diagnosis.

## Best Practices

1. **Run After ChatGPT Updates**: When you notice UI detection failures
2. **Compare Snapshots**: Use diff tools to compare before/after HTML
3. **Update Selectors**: Use the report suggestions to update tool code
4. **Archive Old Snapshots**: Keep a history for reference

## Example Report

```markdown
# ChatGPT UI Diagnosis Report
**Date**: 2025-10-03T17:36:15.000Z
**URL**: https://chatgpt.com/

## Element Detection Results

### ✅ Deep Research Toggle
- **Status**: found
- **Current Selectors**:
  - CSS: `[role="menuitemradio"][aria-label*="Deep"]`
  - XPath: `//div[@role="menuitemradio" and contains(text(), 'Deep research')]`
  - Accessibility: `Text contains: "Deep research"`

### ⚠️ Composer Textarea
- **Status**: structure_changed
- **Current Selectors**:
  - CSS: `[contenteditable="true"]`
- **Details**: Some selectors work, but structure may have changed
- **Suggestion**: Update chatgpt-web.ts line 450

## Files Generated
- HTML: chatgpt-251003-173615.html
- Screenshot: chatgpt-251003-173615.png
- AX Tree: chatgpt-251003-173615-ax.json
- Report: chatgpt-251003-173615-report.md

## Next Steps
1. Review the HTML snapshot to understand current DOM structure
2. Check the screenshot to see visual layout changes
3. Analyze the AX tree JSON for accessibility structure changes
4. Update selectors in relevant tool files based on findings
```

## Troubleshooting

### Common Issues

**Q: Diagnosis fails with "Target closed" error**
- A: Make sure Chrome is still running and connected

**Q: Elements show as "not_found" but they exist**
- A: The UI structure changed significantly. Check the HTML snapshot

**Q: Screenshots are blank**
- A: Increase `waitForLoad` parameter (default: 5000ms)

**Q: Too many files in this directory**
- A: Archive old snapshots to a subdirectory (e.g., `archive/`)

## File Retention

- Keep the 3 most recent snapshots for quick reference
- Archive older snapshots to `archive/` subdirectory
- Delete snapshots older than 6 months unless they document major UI changes
